<div align = "center">
Sep 25, 2021, Saturday<br>
Notes by: Mayank Kumar Prajapati<br>
Module: Comptia Pentest+ Nmap<br>
URL: https://tryhackme.com/room/furthernmap
</div>

***
## Task 1:
Join the room.
```
Joined
````
## Task 2: Introduction
1. What networking constructs are used to direct traffic to the right application on a server?
```
ports
```
2. How many of these are available on any network-enabled computer?
```
65535
```
3. How many of these are considered "well-known"? (These are the "standard" numbers mentioned in the task).
```
1024
```
## Task 3: NMAP Switches
1. What is the first switch listed in the help menu for a 'Syn Scan' (more on this later!)?
```
-sS
```
2. Which switch would you use for a "UDP scan"?
```
-sU
```
3. If you wanted to detect which operating system the target is running on, which switch would you use?
```
-O
```
4. Nmap provides a switch to detect the version of the services running on the target. What is this switch?
```
-sV
```
5. The default output provided by nmap often does not provide enough information for a pentester. How would you increase the verbosity?
```
-v
```
6. Verbosity level one is good, but verbosity level two is better! How would you set the verbosity level to two?
(Note: it's highly advisable to always use at least this option)
```
-vv
```
7. We should always save the output of our scans -- this means that we only need to run the scan once (reducing network traffic and thus chance of detection), and gives us a reference to use when writing reports for clients.
What switch would you use to save the nmap results in three major formats?

8. What switch would you use to save the nmap results in a "normal" format?
```
-oN
```
9. A very useful output format: how would you save results in a "grepable" format?
```
-oG
```
10. Sometimes the results we're getting just aren't enough. If we don't care about how loud we are, we can enable "aggressive" mode. This is a shorthand switch that activates service detection, operating system detection, a traceroute and common script scanning.
How would you activate this setting?
```
-A
```
11. Nmap offers five levels of "timing" template. These are essentially used to increase the speed your scan runs at. Be careful though: higher speeds are noisier, and can incur errors! How would you set the timing template to level 5?
```
-T5
```
12. How would you tell nmap to only scan port 80?
```
-p 80
```
13. How would you tell nmap to scan ports 1000-1500?
```
-p 1000-1500
```
14. A very useful option that should not be ignored:
How would you tell nmap to scan all ports?
```
-p-
```
15. How would you activate a script from the nmap scripting library (lots more on this later!)?
```
--script
```
16. How would you activate all of the scripts in the "vuln" category?
```
--script=vuln
```
## Task 4: Scan Types Overview


When port scanning with Nmap, there are three basic scan types. These are:

    TCP Connect Scans (-sT)
    SYN "Half-open" Scans (-sS)
    UDP Scans (-sU)

Additionally there are several less common port scan types, some of which we will also cover (albeit in less detail). These are:

    TCP Null Scans (-sN)
    TCP FIN Scans (-sF)
    TCP Xmas Scans (-sX)

Most of these (with the exception of UDP scans) are used for very similar purposes, however, the way that they work differs between each scan. This means that, whilst one of the first three scans are likely to be your go-to in most situations, it's worth bearing in mind that other scan types exist.

In terms of network scanning, we will also look briefly at ICMP (or "ping") scanning.

## Task 5: Scan Types TCP Connect Scans



Well, as the name suggests, a TCP Connect scan works by performing the three-way handshake with each target port in turn. In other words, Nmap tries to connect to each specified TCP port, and determines whether the service is open by the response it receives.

For example, if a port is closed, RFC 793 states that:

"... If the connection does not exist (CLOSED) then a reset is sent in response to any incoming segment except another reset.  In particular, SYNs addressed to a non-existent connection are rejected by this means."

In other words, if Nmap sends a TCP request with the SYN flag set to a `closed` port, the target server will respond with a TCP packet with the RST (Reset) flag set. By this response, Nmap can establish that the port is closed.

If, however, the request is sent to an `open` port, the target will respond with a TCP packet with the SYN/ACK flags set. Nmap then marks this port as being open (and completes the handshake by sending back a TCP packet with ACK set).

This is all well and good, however, there is a third possibility.

What if the port is `open, but hidden behind a firewall`?

Many firewalls are configured to simply drop incoming packets. Nmap sends a TCP SYN request, and receives nothing back. This indicates that the port is being protected by a firewall and thus the port is considered to be filtered.

That said, it is very easy to configure a firewall to respond with a RST TCP packet. For example, in IPtables for Linux, a simple version of the command would be as follows:

```zsh
iptables -I INPUT -p tcp --dport <port> -j REJECT --reject-with tcp-reset
```
This can make it extremely difficult (if not impossible) to get an accurate reading of the target(s).


1. Which RFC defines the appropriate behaviour for the TCP protocol?
```
RFC 793
```
2. If a port is closed, which flag should the server send back to indicate this?
```
RST
```
